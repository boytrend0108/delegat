import{C as F}from"./ConfirmEmailForm-5o3i5JAi.js";import{B as x}from"./BankForm-NdoOZAKH.js";import{m as g,b as N,B as y,_ as v,o as r,c as u,y as f,z as I,d as a,n as b,F as D,i as W,t as C,p as A,h as P,V as U,R as H,Q as G,U as K,ab as q,D as X,W as j,X as V,ac as z,r as _,e as d,g as p,f as m,w as c,T as O,v as w,H as R}from"./index-BueGtXLM.js";const Y={name:"da-data_inn",data(){return{inputInn:""}},computed:{...g(["COMPANIES_LIST"]),isInnValid(){return this.inputInn.length===0?!1:!(this.inputInn.length>=10&&this.inputInn.length<=12)}},methods:{...N(["SET_COMPANIES_LIST","SET_NEW_COMPANY_FORM","SET_VALIDATION_ERR","SAVE_INPUT_VALUE"]),...y(["GET_COMPANIES_FROM_DADATA"]),showSuggestions(){this.SET_VALIDATION_ERR("clear"),this.inputInn.length>2&&this.GET_COMPANIES_FROM_DADATA(this.inputInn)},selectCompany(t){this.inputInn=t.target.textContent.split(" ")[0],this.SET_NEW_COMPANY_FORM(this.inputInn),this.SET_COMPANIES_LIST(),this.SAVE_INPUT_VALUE(this.inputInn)},hideDropdown(){this.SET_COMPANIES_LIST()}},watch:{inputInn(){this.inputInn.length>=10?this.$emit("innValidation",!0):this.$emit("innValidation",!1)}},mounted(){this.$refs.inn.focus()}},Q=t=>(A("data-v-0c611f65"),t=t(),P(),t),J={class:"inputInn"},Z=Q(()=>a("p",{class:"formElem__title"},"ИНН компании",-1)),$={class:"companiesDropDown"};function ss(t,s,o,T,n,i){return r(),u("div",J,[Z,f(a("input",{type:"text",class:b(["input",{invalid:i.isInnValid}]),ref:"inn",id:"inn","onUpdate:modelValue":s[0]||(s[0]=l=>n.inputInn=l),onInput:s[1]||(s[1]=(...l)=>i.showSuggestions&&i.showSuggestions(...l))},null,34),[[I,n.inputInn,void 0,{trim:!0}]]),a("ul",$,[(r(!0),u(D,null,W(t.COMPANIES_LIST,(l,h)=>(r(),u("li",{class:"dropDownItem",key:h,onClick:s[2]||(s[2]=(...S)=>i.selectCompany&&i.selectCompany(...S))},[a("p",null,C(l),1)]))),128))])])}const ts=v(Y,[["render",ss],["__scopeId","data-v-0c611f65"]]),es={name:"form-reg-provider",components:{ValidationErrors:U,DaDataInn:ts,BankForm:x},data(){return{showFirstPart:!0,isValid:{name:!1,email:!1,password_1:!1,samePassword:!1,phone:!1,inn:!1,email_firm:!1,phone_firm:!1,bank:!1},value:{password_1:"",password_2:""},isCurrencyValid:null,isBtnEnable:!1,isNextBtnEnable:!1,showPass1:!0,showPass2:!0,inn:"",email_firm:"",phone_firm:"",username:"",email:"",phone:"",username_reg:H,email_reg:G,password_reg:K,phone_reg:q,errorMsg:"",comparePasswordMsg:!1}},computed:{...g(["VALIDATION_ERRORS","IS_VALID","FIRMS","INPUT","BANK","COMPANIES_LIST"])},methods:{...y(["REGISTRATION"]),...N(["SWITCH_IS_VALID","SET_SHOW_LOGIN_FORM","SET_VALIDATION_ERR","SET_FORM_DATA","SET_SHOW_CONFIRM_EMAIL","SET_SHOW_SIGNUP_FORM","SET_DELETE_BANK","SET_COMPANIES_LIST","SET_SHOW_PRELOADER"]),handleFormClick(){this.SET_COMPANIES_LIST()},setInnValidation(t){const s={id:"register"};this.isValid.inn=t,this.isBtnValid(s)},goToSignInForm(){this.SET_VALIDATION_ERR("clear"),this.SET_SHOW_LOGIN_FORM(!0)},numValidationFn(t){this.errorMsg=X(t)},phoneValidation(t){const s=document.querySelector(".btn-next"),o=document.querySelector(".btn-reg");switch(t.lable){case"Ваш телефон":this.isValid.phone=t.status,this.phone=t.phone,this.isBtnValid(s);break;case"Телефон компании":this.isValid.phone_firm=t.status,this.phone_firm=t.phone,this.isBtnValid(o);break}},isBtnValid(t){if(t)switch(t.id){case"register":this.isValid.inn&&this.isValid.email_firm&&this.isValid.phone_firm&&this.isValid.bank===!0?this.isBtnEnable=!0:this.isBtnEnable=!1;break;case"next_step":this.isValid.samePassword&&this.isValid.name&&this.isValid.email&&this.isValid.password_1&&this.isValid.phone===!0?this.isNextBtnEnable=!0:this.isNextBtnEnable=!1}},passwordValidationMsg(){return j(this)},validations(t){t.target.classList.add("invalid");const s=document.querySelector(".btn-reg"),o=document.querySelector(".btn-next");switch(this.INPUT&&(this.isValid.inn=!0),t.target.id){case"name":if(!this.username_reg.test(this.username)){this.isValid.name=!1,this.isBtnValid(o);return}this.isValid.name=!0,t.target.classList.remove("invalid"),this.isBtnValid(o);break;case"email":if(!this.email_reg.test(this.email)){this.isValid.email=!1,this.isBtnValid(o);return}this.isValid.email=!0,t.target.classList.remove("invalid"),this.isBtnValid(o);break;case"email_firm":if(!this.email_reg.test(this.email_firm)){this.isValid.email_firm=!1,this.isBtnValid(s);return}this.isValid.email_firm=!0,t.target.classList.remove("invalid"),this.isBtnValid(s);break;case"password_1":if(!this.password_reg.test(this.value.password_1)){this.isValid.password_1=!1,V(this),this.isBtnValid(o);return}t.target.classList.remove("invalid"),this.isValid.password_1=!0,V(this),this.isBtnValid(o);break;case"password_2":if(this.value.password_1!==this.value.password_2){V(this),this.isBtnValid(o);return}t.target.classList.remove("invalid"),V(this),this.isBtnValid(o);break}},showPassword(t){const s=document.getElementById("password_1"),o=document.getElementById("password_2");if(t==="1"){if(s.attributes.type.textContent==="password"){s.attributes.type.textContent="text",this.showPass1=!this.showPass1;return}s.attributes.type.textContent==="text"&&(s.attributes.type.textContent="password",this.showPass1=!this.showPass1)}else if(t==="2")if(o.attributes.type.textContent==="password"){o.attributes.type.textContent="text",this.showPass2=!this.showPass2;return}else o.attributes.type.textContent="password",this.showPass2=!this.showPass2},onSubmit(){if(this.isCurrencyValid=z(),!this.isCurrencyValid)return;this.SET_SHOW_PRELOADER(!0),this.SET_VALIDATION_ERR("clear");let t={full_name:this.username,email:this.email,password:this.value.password_1,phone_number:this.phone,firm:{inn:this.FIRMS[0].inn,kpp:this.FIRMS[0].kpp,ogrn:this.FIRMS[0].ogrn,long_name:this.FIRMS[0].long_name,address_jur:this.FIRMS[0].address_jur,email:this.email_firm,phone_number:this.phone_firm},bank:{bic:this.BANK[0].bic,ras_schet:this.BANK[0].ras_schet,name:this.BANK[0].name,kor_schet:this.BANK[0].kor_schet}};this.REGISTRATION(t).then(s=>{this.SET_SHOW_PRELOADER(!1),console.log("successfully register user",s),this.SET_FORM_DATA(t),this.SET_SHOW_CONFIRM_EMAIL(!0),this.SET_SHOW_SIGNUP_FORM(!1)}).catch(s=>{console.log(s),this.SET_SHOW_PRELOADER(!1)})}},watch:{BANK:{handler(t){t[0].ras_schet.length===20&&t[0].bic.length===9?this.isValid.bank=!0:this.isValid.bank=!1;const s=document.querySelector("#register");this.isBtnValid(s)},deep:!0},FIRMS:{handler(t){console.log("watcher"),t[0].inn?this.isValid.inn=!0:this.isValid.inn=!1},deep:!0}},mounted(){this.SET_DELETE_BANK(),this.$refs.fio.focus()}},E=t=>(A("data-v-5e15259d"),t=t(),P(),t),is={class:"dialog__content"},ns=E(()=>a("h2",{class:"form-title"},"Регистрация для специалистов",-1)),as={key:0,class:"form-part"},os={class:"input-box"},rs=E(()=>a("label",{for:"name",class:"form-label"},"ФИО",-1)),ls={class:"input-box"},ds=E(()=>a("label",{for:"email",class:"form-label"},"Ваш E-mail",-1)),_s={class:"input-box"},ms=E(()=>a("label",{for:"password",class:"form-label"},"Пароль",-1)),us={key:0,class:"error-msg"},hs={class:"input-box"},ps=E(()=>a("label",{for:"password_2",class:"form-label"},"Повторите пароль",-1)),cs={key:0,class:"error-msg"},fs={key:1,class:"form-part"},Is={class:"input-box"},Es=E(()=>a("label",{for:"email",class:"form-label"},"E-mail компании",-1)),Ss={class:"btn-wr"};function Vs(t,s,o,T,n,i){const l=_("my-phone-code"),h=_("font-awesome-icon"),S=_("my-btn"),M=_("da-data-inn"),k=_("bank-form"),B=_("validation-errors"),L=_("router-link");return r(),u("section",is,[a("form",{class:"form",id:"reg-form",onSubmit:s[16]||(s[16]=R((...e)=>i.onSubmit&&i.onSubmit(...e),["prevent"])),onClick:s[17]||(s[17]=R((...e)=>i.handleFormClick&&i.handleFormClick(...e),["self"]))},[ns,n.showFirstPart?(r(),u("div",as,[a("div",os,[rs,f(a("input",{class:"input-login",type:"text",id:"name",ref:"fio","onUpdate:modelValue":s[0]||(s[0]=e=>n.username=e),onInput:s[1]||(s[1]=(...e)=>i.validations&&i.validations(...e)),placeholder:"ФИО"},null,544),[[I,n.username,void 0,{trim:!0}]])]),d(l,{onPhoneValidation:i.phoneValidation},null,8,["onPhoneValidation"]),a("div",ls,[ds,f(a("input",{class:"input-login",type:"email",id:"email","onUpdate:modelValue":s[2]||(s[2]=e=>n.email=e),onInput:s[3]||(s[3]=e=>i.validations(e)),placeholder:"E-mail"},null,544),[[I,n.email,void 0,{trim:!0}]])]),a("div",_s,[ms,f(a("input",{type:"password",class:"input-login",id:"password_1","onUpdate:modelValue":s[4]||(s[4]=e=>n.value.password_1=e),onInput:s[5]||(s[5]=e=>i.validations(e)),placeholder:"Пароль"},null,544),[[I,n.value.password_1,void 0,{trim:!0}]]),n.showPass1?(r(),p(h,{key:0,icon:"fa-solid fa-eye",onClick:s[6]||(s[6]=e=>i.showPassword("1"))})):m("",!0),n.showPass1?m("",!0):(r(),p(h,{key:1,icon:"fa-solid fa-eye-slash",class:"icon",onClick:s[7]||(s[7]=e=>i.showPassword("1"))})),d(O,{name:"fade"},{default:c(()=>[i.passwordValidationMsg()?(r(),u("p",us,C(i.passwordValidationMsg()),1)):m("",!0)]),_:1})]),a("div",hs,[ps,f(a("input",{class:"input-login",type:"password",id:"password_2","onUpdate:modelValue":s[8]||(s[8]=e=>n.value.password_2=e),onInput:s[9]||(s[9]=(...e)=>i.validations&&i.validations(...e)),placeholder:"Пароль"},null,544),[[I,n.value.password_2,void 0,{trim:!0}]]),n.showPass2?(r(),p(h,{key:0,icon:"fa-solid fa-eye",class:"icon",onClick:s[10]||(s[10]=e=>i.showPassword("2"))})):m("",!0),n.showPass2?m("",!0):(r(),p(h,{key:1,icon:"fa-solid fa-eye-slash",onClick:s[11]||(s[11]=e=>i.showPassword("2"))})),d(O,{name:"fade"},{default:c(()=>[n.comparePasswordMsg?(r(),u("p",cs,"Пароли не совпадают")):m("",!0)]),_:1})]),d(S,{class:b(["btn btn-next",{BtnEnable:!n.isNextBtnEnable}]),id:"next_step",disabled:!n.isNextBtnEnable,onClick:s[12]||(s[12]=e=>n.showFirstPart=!1)},{default:c(()=>[w("Следующий шаг")]),_:1},8,["class","disabled"])])):(r(),u("div",fs,[d(M,{onInnValidation:i.setInnValidation},null,8,["onInnValidation"]),a("div",Is,[Es,f(a("input",{class:"input-login",type:"email",id:"email_firm","onUpdate:modelValue":s[13]||(s[13]=e=>n.email_firm=e),onInput:s[14]||(s[14]=e=>i.validations(e)),placeholder:"E-mail компании"},null,544),[[I,n.email_firm,void 0,{trim:!0}]])]),d(l,{onPhoneValidation:i.phoneValidation,inputLable:"Телефон компании"},null,8,["onPhoneValidation"]),d(k,{class:"bank-form",isCurrencyValid:n.isCurrencyValid},null,8,["isCurrencyValid"]),a("div",Ss,[d(S,{class:"btn btn-back",onClick:s[15]||(s[15]=e=>n.showFirstPart=!0)},{default:c(()=>[w("Назад")]),_:1}),d(S,{type:"submit",class:b(["btn btn-reg",{BtnEnable:!n.isBtnEnable}]),id:"register",disabled:!n.isBtnEnable},{default:c(()=>[w("Зарегистрироваться")]),_:1},8,["class","disabled"])]),t.VALIDATION_ERRORS?(r(),p(B,{key:0,"validation-errors":t.VALIDATION_ERRORS},null,8,["validation-errors"])):m("",!0)]))],32),d(L,{to:"/provider/signin",class:"form__question",onClick:i.goToSignInForm},{default:c(()=>[w(" Уже есть аккaунт? ")]),_:1},8,["onClick"])])}const ws=v(es,[["render",Vs],["__scopeId","data-v-5e15259d"]]),bs={components:{ConfirmEmailForm:F,FormRegProvider:ws},computed:{...g(["SHOW_SIGNUP_FORM","SHOW_CONFIRM_EMAIL"])}},gs=t=>(A("data-v-6f2ce96d"),t=t(),P(),t),vs={class:"registration"},As=gs(()=>a("h1",{class:"visually-hidden"},"Регистрация исполнителя",-1));function Ps(t,s,o,T,n,i){const l=_("form-reg-provider"),h=_("confirm-email-form");return r(),u("div",vs,[As,t.SHOW_SIGNUP_FORM===!0?(r(),p(l,{key:0})):m("",!0),t.SHOW_CONFIRM_EMAIL===!0?(r(),p(h,{key:1,class:"confirm-email"})):m("",!0)])}const Ns=v(bs,[["render",Ps],["__scopeId","data-v-6f2ce96d"]]);export{Ns as default};
