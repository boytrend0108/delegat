import{V as y,m as D,b as g,B as f,D as R,_ as O,r as p,o as n,c as _,g as d,f as a,d as t,y as l,z as u,e as T,F as k,i as I,t as B,w as b,v as K,n as M,H as v,p as L,h as V}from"./index-BhtDRTVm.js";const w={name:"bank-form",components:{ValidationErrors:y},props:{isCurrencyValid:{type:Boolean}},data(){return{inputBic:"",bankName:"",kor_schet:"",ras_schet:"",errorMsgBic:"",errorMsgBill:"",currency_type_error:""}},computed:{...D(["INPUT","INPUT_ID","FID","VALIDATION_ERRORS","FIRM","BANKS_LIST","BANK","ADD_OR_CHANGE_BANK"]),isDisabled(){return!(this.BANK[0].bic&&this.BANK[0].ras_schet&&this.BANK[0].ras_schet.length===20)}},methods:{...g(["SHOW_DIALOG","SET_NEW_BANK_FORM","SET_BANKS_LIST","SET_BANK_FORM","SET_VALIDATION_ERR","SET_SHOW_PRELOADER"]),...f(["SEND_BANK_TO_SERVER","GET_BANKS_FROM_DADATA","UPDATE_BANK"]),showSuggestions(){this.SET_VALIDATION_ERR("clear"),this.inputBic.length>2&&this.GET_BANKS_FROM_DADATA(this.inputBic)},selectBank(s){this.inputBic=s.target.textContent.split(" ")[0],this.SET_NEW_BANK_FORM(this.inputBic),this.updateForm(),this.SET_BANKS_LIST(),this.$refs.ras_schet.focus()},onSubmit(){debugger;this.SET_SHOW_PRELOADER(!0);const s={name:this.BANK[0].name,bic:this.BANK[0].bic,ras_schet:this.BANK[0].ras_schet,kor_schet:this.BANK[0].kor_schet};if(this.BANK[0].ras_schet.slice(5,8)!=="810"){this.currency_type_error="Не верно указан номер рублёвого счета",setTimeout(()=>{this.currency_type_error=""},3e3),this.SET_SHOW_PRELOADER(!1);return}switch(this.ADD_OR_CHANGE_BANK){case"addNewBank":this.SEND_BANK_TO_SERVER(s).then(()=>{this.SET_SHOW_PRELOADER(!1),this.SHOW_DIALOG("addCompanyDetails")}).catch(c=>{this.SET_SHOW_PRELOADER(!1),console.log(c)});break;case"changeBank":this.UPDATE_BANK(s).then(()=>{this.SET_SHOW_PRELOADER(!1),this.SHOW_DIALOG("addCompanyDetails")}).catch(c=>{this.SET_SHOW_PRELOADER(!1),console.log(c)});break}},updateForm(){this.inputBic=this.BANK[0].bic,this.bankName=this.BANK[0].name,this.kor_schet=this.BANK[0].kor_schet,this.ras_schet=this.BANK[0].ras_schet},setInput(s){if(s.target.id==="ИНН"){if(document.querySelector(".companiesDropDown").style.display="none",this.errorMsgBic)return;document.querySelector(".companiesDropDown").style.display="flex",this.showSuggestions()}else{if(this.errorMsgBill=R(s),this.errorMsgBill)return;this.ras_schet.length!==20?(this.errorMsgBill=`Введите 20 цифр. Ceйчас ${this.ras_schet.length}`,s.target.classList.add("invalid"),this.SET_BANK_FORM(this.ras_schet)):(this.errorMsgBill="",s.target.classList.remove("invalid"),this.SET_BANK_FORM(this.ras_schet))}}},watch:{isCurrencyValid(){this.isCurrencyValid?this.currency_type_error="":this.currency_type_error="Не верно указан номер рублёвого счета"}},mounted(){this.updateForm(),this.$route.name!=="provider-signup"&&this.$refs.autofocus.focus(),this.ras_schet=this.BANK[0].ras_schet?this.BANK[0].ras_schet:""}},h=s=>(L("data-v-32b3c4d2"),s=s(),V(),s),F={key:0,class:"form-title"},C={key:1,class:"form-title_signup"},H={class:"inputBic"},W=h(()=>t("p",{class:"formElem__title"},"БИК/Название банка",-1)),P={class:"companiesDropDown"},x={class:"inputBic"},G=h(()=>t("p",{class:"formElem__title"},"Haименование банка",-1)),U={class:"inputBic"},q=h(()=>t("p",{class:"formElem__title"},"Расчётный счёт",-1)),z={class:"input__wr"},j={key:0,class:"marker"},J=["errorMsg"],Q={class:"inputBic"},X=h(()=>t("p",{class:"formElem__title"},"Корреспондентский счёт",-1)),Y={class:"btn-wr"};function Z(s,e,c,$,r,o){const A=p("validation-errors"),m=p("my-validation-error-msg"),E=p("my-color-btn");return n(),_("form",{class:"bank-form",onSubmit:e[7]||(e[7]=v((...i)=>o.onSubmit&&o.onSubmit(...i),["prevent"]))},[s.$route.name!=="provider-signup"?(n(),_("h2",F,"Банковские реквизиты")):(n(),_("h2",C,"Банковские реквизиты")),this.VALIDATION_ERRORS?(n(),d(A,{key:2,"validation-errors":this.VALIDATION_ERRORS,class:"error"},null,8,["validation-errors"])):a("",!0),t("div",H,[W,l(t("input",{type:"text",id:"ИНН",class:"input","onUpdate:modelValue":e[0]||(e[0]=i=>r.inputBic=i),onInput:e[1]||(e[1]=(...i)=>o.setInput&&o.setInput(...i)),ref:"autofocus"},null,544),[[u,r.inputBic]]),T(m,{errorMsg:r.errorMsgBic},null,8,["errorMsg"]),t("ul",P,[(n(!0),_(k,null,I(s.BANKS_LIST,(i,S)=>(n(),_("li",{class:"dropDownItem",key:S,onClick:e[2]||(e[2]=(...N)=>o.selectBank&&o.selectBank(...N))},[t("p",null,B(i),1)]))),128))])]),t("div",x,[G,l(t("input",{type:"text",class:"input cursor","onUpdate:modelValue":e[3]||(e[3]=i=>r.bankName=i),disabled:""},null,512),[[u,r.bankName]])]),t("div",U,[q,t("div",z,[l(t("input",{id:"ras_schet",type:"text",class:"input","onUpdate:modelValue":e[4]||(e[4]=i=>r.ras_schet=i),ref:"ras_schet",onInput:e[5]||(e[5]=(...i)=>o.setInput&&o.setInput(...i))},null,544),[[u,r.ras_schet,void 0,{trim:!0}]]),r.currency_type_error?(n(),_("div",j)):a("",!0)]),r.errorMsgBill?(n(),d(m,{key:0,errorMsg:r.errorMsgBill,class:"error"},null,8,["errorMsg"])):a("",!0),r.currency_type_error?(n(),_("p",{key:1,errorMsg:r.currency_type_error,class:"errorMsg"},B(r.currency_type_error),9,J)):a("",!0)]),t("div",Q,[X,l(t("input",{type:"text",class:"input cursor","onUpdate:modelValue":e[6]||(e[6]=i=>r.kor_schet=i),disabled:""},null,512),[[u,r.kor_schet]])]),t("div",Y,[s.$route.name!=="provider-signup"?(n(),d(E,{key:0,class:M(["btn",{disabled:o.isDisabled}]),type:"submit",disabled:o.isDisabled},{default:b(()=>[K("Сохранить")]),_:1},8,["disabled","class"])):a("",!0)])],32)}const es=O(w,[["render",Z],["__scopeId","data-v-32b3c4d2"]]);export{es as B};
