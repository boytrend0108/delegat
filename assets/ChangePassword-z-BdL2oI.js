import{V as E,ai as I,m as f,b,B as R,_ as A,r as o,o as r,g as l,w as d,d as n,y as T,z as g,n as S,f as _,e as O,v as D,H as C,c as v,p as w,h as N}from"./index-BhtDRTVm.js";const V={name:"change-password",components:{ValidationErrors:E,MyBigSpinner:I},data(){return{title:"Смена пароля",isBtnEnable:!0,email:"",email_reg:/.+@.+\..+/i,showPreloader:!1}},computed:{...f(["IS_VALID","CURRENT_USER","VALIDATION_ERRORS"]),isInputDisabled(){return!(this.$route.name==="customer-signin"||this.$route.name==="provider-signin")},showMsg(){return!(this.$route.path==="/customer/profile"||this.$route.path==="/provider/profile")}},methods:{...b(["SWITCH_IS_VALID","SET_FORM_DATA","SET_VALIDATION_ERR","SET_SHOW_CHANGE_PASSWORD","SET_SHOW_CONFIRM_EMAIL","SET_SHOW_CHECK_EMAIL","SET_SHOW_SIGNUP_FORM"]),...R(["RESET_PASSWORD"]),sendFormData(e,t){const m={email:e,password:t};this.SET_FORM_DATA(m)},validations(e){this.sendFormData(this.email,""),this.SWITCH_IS_VALID(!1);const t=document.querySelector(".btn");t.setAttribute("disabled","disabled"),this.email_reg.test(this.email)&&e.target.id==="email"&&e.target.classList.remove("invalid"),this.email_reg.test(this.email)?(this.SWITCH_IS_VALID(!0),this.isBtnEnable=!0,t.removeAttribute("disabled")):(this.SWITCH_IS_VALID(!1),this.isBtnEnable=!1)},async onSubmit(){this.showPreloader=!0;const e=this.$route.path.split("/")[1];localStorage.setItem("site_role",`${e}`),this.SET_SHOW_CHANGE_PASSWORD(!0),this.RESET_PASSWORD(this.email).then(()=>this.showPreloader=!1).catch(()=>this.showPreloader=!1)},goToSignUpPage(){this.SET_SHOW_CHANGE_PASSWORD(!1),this.SET_SHOW_SIGNUP_FORM(!0);const e=this.$route.path.split("/")[1];this.$router.push(`/${e}/signup`)}},mounted(){this.CURRENT_USER?this.email=this.CURRENT_USER.email:this.email=""}},H=e=>(w("data-v-5b222f0b"),e=e(),N(),e),P={class:"input-box"},W=H(()=>n("label",{for:"email_2",class:"form-label"},"E-mail",-1)),y=["disabled"];function L(e,t,m,M,a,s){const u=o("validation-errors"),h=o("my-big-spinner"),p=o("my-btn"),c=o("my-window");return r(),l(c,{title:a.title},{default:d(()=>[n("form",{class:"form",id:"form2",onSubmit:t[2]||(t[2]=C((...i)=>s.onSubmit&&s.onSubmit(...i),["prevent"]))},[n("div",P,[W,T(n("input",{placeholder:"E-mail",class:S(["input-login",{invalid:!e.IS_VALID}]),type:"email",id:"email_2",onInput:t[0]||(t[0]=i=>s.validations(i)),"onUpdate:modelValue":t[1]||(t[1]=i=>a.email=i),disabled:s.isInputDisabled},null,42,y),[[g,a.email,void 0,{trim:!0}]])]),e.VALIDATION_ERRORS?(r(),l(u,{key:0,"validation-errors":e.VALIDATION_ERRORS},null,8,["validation-errors"])):_("",!0),a.showPreloader?(r(),l(h,{key:1})):_("",!0),O(p,{form:"form2",type:"submit",class:S(["btn",{BtnEnable:!a.isBtnEnable}])},{default:d(()=>[D("Cменить пароль ")]),_:1},8,["class"])],32),s.showMsg?(r(),v("p",{key:0,class:"form__question",onClick:t[3]||(t[3]=(...i)=>s.goToSignUpPage&&s.goToSignUpPage(...i))}," Eще нет аккaунта?")):_("",!0)]),_:1},8,["title"])}const B=A(V,[["render",L],["__scopeId","data-v-5b222f0b"]]);export{B as C};
