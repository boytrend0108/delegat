import{V as v,Q as w,U as O,m as b,B as P,b as L,aa as D,_ as C,r as l,o as n,c as h,d as o,v as u,f as c,y as S,z as I,n as _,g as d,e as m,w as g,H as y,p as V,h as N}from"./index-CJPfqmld.js";const k={name:"form-login",components:{ValidationErrors:v},props:{site_role:String},data(){return{isBtnEnable:!0,showPass1:!0,showPass2:!0,email:"",password:"",email_reg:w,password_reg:O}},computed:{...b(["IS_VALID","EMAIL","PASSWORD","VALIDATION_ERRORS","IS_APPLICATION_COMPLETE"])},methods:{...P(["LOGIN","GET_EMAIL","CURRENT_USER","ATTEMPT"]),...L(["SWITCH_IS_VALID","SET_FORM_DATA","SET_SHOW_CHANGE_PASSWORD","SET_SHOW_LOGIN_FORM","SET_VALIDATION_ERR","SET_IS_APPLICATION_COMPLETE","SET_SHOW_PRELOADER"]),goToRegistrationPage(){const t=this.$route.path.split("/")[1];this.SET_VALIDATION_ERR("clear"),this.$router.push(`/${t}/signup`)},sendFormData(t,e){const i={email:t,password:e};this.SET_FORM_DATA(i)},clearForm(){this.email="",this.password=""},clickHandler(){this.SET_SHOW_LOGIN_FORM(!1),this.SET_SHOW_CHANGE_PASSWORD(!0)},showPassword(t){const e=document.getElementById("password_1");if(t==="1"){if(e.attributes.type.textContent==="password"){e.attributes.type.textContent="text",this.showPass1=!this.showPass1;return}e.attributes.type.textContent==="text"&&(e.attributes.type.textContent="password",this.showPass1=!this.showPass1)}},validations(t){this.sendFormData(this.email,this.password),this.SWITCH_IS_VALID(!1);const e=document.querySelector(".btn");e.setAttribute("disabled","disabled"),this.email_reg.test(this.email)&&t.target.id==="email"&&t.target.classList.remove("invalid"),this.email_reg.test(this.email)&&this.password_reg.test(this.password)?(this.SWITCH_IS_VALID(!0),this.isBtnEnable=!0,e.removeAttribute("disabled")):(this.SWITCH_IS_VALID(!1),this.isBtnEnable=!1)},async onSubmit(){this.SET_SHOW_PRELOADER(!0),this.SET_VALIDATION_ERR("clear");const t={login:this.email,password:this.password};this.LOGIN(t).then(e=>{const i=this.$route.path.split("/")[1];this.ATTEMPT(e).then(()=>{switch(D(),i){case"customer":!localStorage.getItem("selected_service")&&!localStorage.getItem("currentRoute")?this.$router.push("/customer/my_applications"):localStorage.getItem("selected_service")==="delivery"?(this.$router.push("/start-application"),localStorage.setItem("selected_service","")):localStorage.getItem("selected_service")==="search"?(this.$router.push("/search_product/?step=SearchProductComp"),localStorage.setItem("selected_service","")):localStorage.getItem("selected_service")==="cost_calc"?(this.$router.push("/cost-calculation?step=FromWhichCountry"),localStorage.setItem("selected_service","")):localStorage.getItem("selected_service")==="manager"?(this.$router.push("/?#manager"),localStorage.setItem("selected_service","")):localStorage.getItem("currentRoute")&&(localStorage.getItem("currentRoute").includes("verification_code")?(this.$router.push("/customer/my_applications"),localStorage.setItem("currentRoute","")):(this.$router.push(`${localStorage.getItem("currentRoute")}`),localStorage.setItem("currentRoute","")));break;case"provider":localStorage.getItem("currentRoute")?localStorage.getItem("currentRoute").includes("verification_code")?(this.$router.push("/provider/search/"),localStorage.setItem("currentRoute","")):(this.$router.push(`${localStorage.getItem("currentRoute")}`),localStorage.setItem("currentRoute","")):this.$router.push("/provider/search/");break}this.SET_SHOW_PRELOADER(!1)})}).catch(e=>{console.log(e),this.SET_SHOW_PRELOADER(!1)})}},mounted(){this.SET_VALIDATION_ERR("clear")}},f=t=>(V("data-v-8a5ab480"),t=t(),N(),t),H={class:"dialog__content"},W={class:"form__title-box"},M={class:"form-title"},x={key:0,class:"form-title"},B={class:"input-box"},F=f(()=>o("label",{for:"email",class:"form-label"},"E-mail",-1)),G={class:"input-box"},U=f(()=>o("label",{for:"password",class:"form-label"},"Пароль",-1)),q={class:"question-box"};function $(t,e,i,z,r,a){const p=l("font-awesome-icon"),E=l("my-btn"),R=l("validation-errors"),A=l("router-link"),T=l("my-form-offer");return n(),h("section",H,[o("form",{class:"form",id:"login-form",onSubmit:e[6]||(e[6]=y((...s)=>a.onSubmit&&a.onSubmit(...s),["prevent"]))},[o("div",W,[o("h2",M,[u("Вход "),i.site_role?(n(),h("span",x," для специалиста")):c("",!0)])]),o("div",B,[F,S(o("input",{placeholder:"E-mail",autocomplete:"email",class:_(["input-login",{invalid:!t.IS_VALID}]),type:"email",id:"email",onInput:e[0]||(e[0]=s=>a.validations(s)),"onUpdate:modelValue":e[1]||(e[1]=s=>r.email=s)},null,34),[[I,r.email,void 0,{trim:!0}]])]),o("div",G,[U,S(o("input",{placeholder:"Пароль",type:"password",class:_(["input-login",{invalid:!t.IS_VALID}]),id:"password_1","onUpdate:modelValue":e[2]||(e[2]=s=>r.password=s),autocomplete:"current-password",onInput:e[3]||(e[3]=(...s)=>a.validations&&a.validations(...s))},null,34),[[I,r.password,void 0,{trim:!0}]]),r.showPass1?(n(),d(p,{key:0,icon:"fa-solid fa-eye",onClick:e[4]||(e[4]=s=>a.showPassword("1"))})):c("",!0),r.showPass1?c("",!0):(n(),d(p,{key:1,icon:"fa-solid fa-eye-slash",onClick:e[5]||(e[5]=s=>a.showPassword("1"))}))]),m(E,{type:"submit",class:_(["btn",{BtnEnable:!r.isBtnEnable}])},{default:g(()=>[u("Войти")]),_:1},8,["class"]),t.VALIDATION_ERRORS?(n(),d(R,{key:0,"validation-errors":t.VALIDATION_ERRORS},null,8,["validation-errors"])):c("",!0)],32),o("div",q,[m(A,{onClick:a.goToRegistrationPage,to:"/customer/signup",class:"form__question"},{default:g(()=>[u(" Eще нет аккaунта?")]),_:1},8,["onClick"]),o("p",{class:"form__question",onClick:e[7]||(e[7]=(...s)=>a.clickHandler&&a.clickHandler(...s))}," Забыли пароль?"),m(T)])])}const Q=C(k,[["render",$],["__scopeId","data-v-8a5ab480"]]);export{Q as F};
